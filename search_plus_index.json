{"./":{"url":"./","title":"Hive","keywords":"","body":"HiveHive Hive 는 Hadoop의 데이터를 다루는 SQL 질의의 표준이다. HDFS의 데이터를 SQL로 접근할 수 있는 방법을 제공한다. Hive Query Language, 즉 HQL을 사용하여 RDBMS의 표준 SQL과 비슷한 의미와 함수를 가지며, RDBMS 경험자라면 손쉽게 사용할 수 있다. 또한, HDFS 상에서 High 레벨의 데이터 모델이며, 테이블과 같은 구조를 제공한다. Hive는 table, partition, bucket, 세개의 데이터 구조를 지원하고 table을 HDFS 디렉토리에 대응하고, 이를 파티션으로 분할할 수 있으며, 파티션을 버킷으로 차례대로 나눌 수 있다. TIMESTAMP, STRING, FLOAT, BOOLEAN, DECIMAL, DOUBLE, INT, SMALLINT, BIGINT 같은 primitive(원시) 데이터 포매스이 대부분을 지원하고 UNION, STRUCT, MAP, ARRAY 와 같은 복잡한 데이터 연산을 지원한다. Hive Architecture [출처](https://medium.com/plumbersofdatascience/hive-architecture-in-depth-ba44e8946cbc) 위 그림은 하이브 아키텍처를 그린것으로, metadata store 는 내장, 로컬, 원격 데이터베이스를 사용할 수 있다. Apache Thrift를 통해 Hive에 접근할 수 있고, CLI와 웹 인터페이스를 활용할 수 있다. Hive의 장점을 모아 보면 다음과 같다 Hive는 Map/Reduce 보다 간단하고, 간단한 질의 모델을 개발방법을 제공한다. HQL과 SQL 문법이 비슷하다 쉽게 분석할 수 있는 여러 API, 함수를 제공한다. 많은 데이터 집합에서 동일한 타입의 질의 응답 시간은 여타 질의 응답 시간보다 일반적으로 훨씬 빠르다 여러 컴퓨팅 프레임워크에서 동작한다. HDFS에 애드혹 질의를 할 수 있다. Hive는 사용자가 정의한 함수, 스크립트, 사용자 I/O등의 확장가능한 기술을 제공한다. "},"Installation.html":{"url":"Installation.html","title":"설치","keywords":"","body":"설치Hive 1.2.2MySQL 설치Hive 다운로드설정에러해결설치 Hive 1.2.2 Hive는 기본 메타데이터 저장소로 derby를 사용하지만, 외부 데이터 베이스로 MySQL, PostgreSQL를 사용할 수 있다. MySQL은 메타데이터를 저장할 노드에만 설치하면 된다. MySQL 설치 yum -y install http://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm yum -y install mysql-community-server systemctl start mysqld systemctl enable mysqld 최초 실행시 아래처럼 임시 비밀번호를 조회하여 접속할 수 있다. cat /var/log/mysqld.log ## [Note] A temporary password is generated for root@localhost: ****** 접속 후 비밀번호를 재설정 해줘야 한다. mysql -u root -p ALTER USER 'root'@'localhost' IDENTIFIED BY '*****'; FLUSH PRIVILEGES; SET GLOBAL validate_password_policy=LOW; SET GLOBAL validate_password_length=4; use mysql CREATE USER 'hive'@'%' IDENTIFIED BY 'hive'; GRANT ALL ON *.* TO 'hive'@'%' IDENTIFIED BY 'hive'; FLUSH PRIVILEGES; exit hive 접속 테스트 mysql -u hive -p Hive 다운로드 wget http://mirror.apache-kr.org/hive/hive-1.2.2/apache-hive-1.2.2-bin.tar.gz tar xvf apache-hive-1.2.2-bin.tar.gz mv apache-hive-1.2.2-bin /opt/hive-1.2.2 chown -R hive:hadoop /opt/hive-1.2.2 chmod -R g+w /opt/hive-1.2.2 설정 vim /etc/profile.d/hive.sh export HIVE_HOME=/opt/hive-1.2.2 export PATH=$PATH:$HIVE_HOME/bin:$HIVE_HOME/conf source /etc/profile.d/hive.sh cd $HIVE_HOME/conf cp hive-default.xml.template hive-site.xml cp hive-env.sh.template hive-env.sh cp hive-exec-log4j.properties.template hive-exec-log4j.properties cp hive-log4j.properties.template hive-log4j.properties 설정파일 수정 : vim hive-env.sh export HADOOP_HOME=/opt/hadoop-2.7.7 export HIVE_CONF_DIR=/opt/hive-1.2.2/conf vim hive-site.xml ... javax.jdo.option.ConnectionURL jdbc:mysql://centos-namenode-1/hive?createDatabaseIfNotExist=true JDBC connect string for a JDBC metastore javax.jdo.option.ConnectionDriverName com.mysql.jdbc.Driver Driver class name for a JDBC metastore javax.jdo.option.ConnectionUserName hive Username to use against metastore database javax.jdo.option.ConnectionPassword hive password to use against metastore database ... JDBC 다운로드 : cd $HIVE_HOME/lib wget http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.27.tar.gz tar xvf mysql*.gz cp mysql-connector-java-5.1.27/*.jar $HIVE_HOME/lib HDFS hive 계정 및 디렉토리 생성 : hdfs dfs -mkdir -p /user/hive/warehouse hdfs dfs -chown -R hive:hadoop /user/hive hdfs dfs -chmod -R g+w /user/hive/ Mysql 메타데이터 테이블 생성 : $HIVE_HOME/bin/schematool -initSchema -dbType mysql 접속 테스트 : hive 에러해결 Exception in thread \"main\" java.lang.RuntimeException: java.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: ${system:java.io.tmpdir%7D/$%7Bsystem:user.name%7D : 다음을 hive-site.xml 끝에 추가한다 system:java.io.tmpdir /tmp/hive/java system:user.name ${user.name} $SPARK_HOME/lib/spark-assembly-*.jar 찾을 수 없다 에러, Spark 2.0 버전과의 호환성 문제, $HIVE_HOME/bin/hive 스크립트 수정 vim $HIVE_HOME/bin/hive # add Spark assembly jar to the classpath if [[ -n \"$SPARK_HOME\" ]] then sparkAssemblyPath=`ls ${SPARK_HOME}/jar/*.jar` CLASSPATH=\"${CLASSPATH}:${sparkAssemblyPath}\" fi "},"DDL.html":{"url":"DDL.html","title":"L","keywords":"","body":"DDLDDL LanguageManual DDL 공식문서 "}}